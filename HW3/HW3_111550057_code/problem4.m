
disp('< Promblem 4 >')
y = [0.2, 0.4, 0.5, 0.7; 0.2, 0.4, 0.5, 0.7; 0.2, 0.4, 0.5, 0.7; 0.2, 0.4, 0.5, 0.7];
x = [1.3, 1.3, 1.3, 1.3; 2.5, 2.5, 2.5, 2.5; 3.1, 3.1, 3.1, 3.1; 4.7, 4.7, 4.7, 4.7];
z = [2.521, 2.792, 2.949, 3.314; 3.721, 3.992, 4.149, 4.514; 4.321, 4.592, 4.749, 5.114; 5.921, 6.192, 6.349, 6.714];

M = [-1, 3, -3, 1;
     3, -6, 3, 0;
     -3, 0, 3, 0;
     1, 4, 1, 0];
M = (1/6) .* M;

syms u v;
U = [u.^3; u.^2; u; ones(size(u))];
V = [v.^3; v.^2; v; ones(size(v))];
U = U';
V = V';

X = U * M * x * M' * V';
Y = U * M * y * M' * V';
Z = U * M * z * M' * V';

x_i = 2.8;
y_i = 0.54;

u_val = (x_i-1.3)/3.4; 
v_val = (y_i-0.2)/0.5;

result = subs(Z, [u, v], [u_val, v_val]);
z_val = double(result);
disp(['z(2.8, 0.54) = ',num2str(z_val)]);
